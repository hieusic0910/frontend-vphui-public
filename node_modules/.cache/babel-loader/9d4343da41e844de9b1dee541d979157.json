{"ast":null,"code":"import _regeneratorRuntime from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/Users/hieutran/Desktop/create-social-network-master/frontend/src/pages/Auth/SignIn.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport styled from 'styled-components';\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport { Error } from 'components/Text';\nimport { InputText, Button } from 'components/Form';\nimport { SIGN_IN } from 'graphql/user';\nimport * as Routes from 'routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Root = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: space-between;\\n  font-size: \", \";\\n  margin-top: \", \";\\n\"])), function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.spacing.sm;\n});\n_c = Root;\nvar InputContainer = styled(Spacing)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n\"])));\n_c2 = InputContainer;\nvar ErrorMessage = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: 1px;\\n\"])));\n_c3 = ErrorMessage;\nvar ForgotPassword = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  font-size: \", \";\\n  margin-top: \", \";\\n  color: \", \";\\n\"])), function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.spacing.xxs;\n}, function (p) {\n  return p.theme.colors.white;\n});\n/**\n * Sign In page\n */\n\n_c4 = ForgotPassword;\n\nvar SignIn = function SignIn(_ref) {\n  _s();\n\n  var history = _ref.history,\n      location = _ref.location,\n      refetch = _ref.refetch;\n\n  var _useState = useState({\n    emailOrUsername: '',\n    password: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      values = _useState2[0],\n      setValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useMutation = useMutation(SIGN_IN),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      signin = _useMutation2[0],\n      loading = _useMutation2[1].loading;\n\n  useEffect(function () {\n    setError('');\n  }, [location.pathname]);\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setValues(_objectSpread(_objectSpread({}, values), {}, _defineProperty({}, name, value)));\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!(!emailOrUsername || !password)) {\n                _context.next = 4;\n                break;\n              }\n\n              setError('All fields are required');\n              return _context.abrupt(\"return\");\n\n            case 4:\n              setError('');\n              _context.prev = 5;\n              _context.next = 8;\n              return signin({\n                variables: {\n                  input: {\n                    emailOrUsername: emailOrUsername,\n                    password: password\n                  }\n                }\n              });\n\n            case 8:\n              response = _context.sent;\n              localStorage.setItem('token', response.data.signin.token);\n              _context.next = 12;\n              return refetch();\n\n            case 12:\n              history.push(Routes.HOME);\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](5);\n              setError(_context.t0.graphQLErrors[0].message);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 15]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var emailOrUsername = values.emailOrUsername,\n      password = values.password;\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: /*#__PURE__*/_jsxDEV(Root, {\n      children: [/*#__PURE__*/_jsxDEV(InputContainer, {\n        children: [error && /*#__PURE__*/_jsxDEV(ErrorMessage, {\n          children: /*#__PURE__*/_jsxDEV(Error, {\n            size: \"xxs\",\n            color: \"white\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(InputText, {\n          autoFocus: true,\n          type: \"text\",\n          name: \"emailOrUsername\",\n          values: emailOrUsername,\n          onChange: handleChange,\n          placeholder: \"Email or Username\",\n          borderColor: \"white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(InputContainer, {\n        left: \"xs\",\n        right: \"xs\",\n        children: [/*#__PURE__*/_jsxDEV(InputText, {\n          type: \"password\",\n          name: \"password\",\n          values: password,\n          onChange: handleChange,\n          placeholder: \"Password\",\n          borderColor: \"white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(A, {\n          to: Routes.FORGOT_PASSWORD,\n          children: /*#__PURE__*/_jsxDEV(ForgotPassword, {\n            children: \"Forgot password?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Button, {\n        disabled: loading,\n        children: \"Log in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(SignIn, \"Bd0CWa8PQWC/xjf0zPIbIBaGrUs=\", false, function () {\n  return [useMutation];\n});\n\n_c5 = SignIn;\nSignIn.propTypes = {\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired\n};\nexport default _c6 = withRouter(SignIn);\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"Root\");\n$RefreshReg$(_c2, \"InputContainer\");\n$RefreshReg$(_c3, \"ErrorMessage\");\n$RefreshReg$(_c4, \"ForgotPassword\");\n$RefreshReg$(_c5, \"SignIn\");\n$RefreshReg$(_c6, \"%default%\");","map":{"version":3,"sources":["/Users/hieutran/Desktop/create-social-network-master/frontend/src/pages/Auth/SignIn.js"],"names":["React","useState","useEffect","PropTypes","withRouter","useMutation","styled","A","Spacing","Error","InputText","Button","SIGN_IN","Routes","Root","div","p","theme","font","size","xxs","spacing","sm","InputContainer","ErrorMessage","ForgotPassword","colors","white","SignIn","history","location","refetch","emailOrUsername","password","values","setValues","error","setError","signin","loading","pathname","handleChange","e","target","name","value","handleSubmit","preventDefault","variables","input","response","localStorage","setItem","data","token","push","HOME","graphQLErrors","message","FORGOT_PASSWORD","propTypes","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport styled from 'styled-components';\n\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport { Error } from 'components/Text';\nimport { InputText, Button } from 'components/Form';\n\nimport { SIGN_IN } from 'graphql/user';\n\nimport * as Routes from 'routes';\n\nconst Root = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: space-between;\n  font-size: ${(p) => p.theme.font.size.xxs};\n  margin-top: ${(p) => p.theme.spacing.sm};\n`;\n\nconst InputContainer = styled(Spacing)`\n  width: 100%;\n`;\n\nconst ErrorMessage = styled.div`\n  position: absolute;\n  top: 1px;\n`;\n\nconst ForgotPassword = styled.div`\n  font-size: ${(p) => p.theme.font.size.xxs};\n  margin-top: ${(p) => p.theme.spacing.xxs};\n  color: ${(p) => p.theme.colors.white};\n`;\n\n/**\n * Sign In page\n */\nconst SignIn = ({ history, location, refetch }) => {\n  const [values, setValues] = useState({ emailOrUsername: '', password: '' });\n  const [error, setError] = useState('');\n  const [signin, { loading }] = useMutation(SIGN_IN);\n\n  useEffect(() => {\n    setError('');\n  }, [location.pathname]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setValues({ ...values, [name]: value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!emailOrUsername || !password) {\n      setError('All fields are required');\n      return;\n    }\n\n    setError('');\n    try {\n      const response = await signin({\n        variables: { input: { emailOrUsername, password } },\n      });\n      localStorage.setItem('token', response.data.signin.token);\n      await refetch();\n      history.push(Routes.HOME);\n    } catch (error) {\n      setError(error.graphQLErrors[0].message);\n    }\n  };\n\n  const { emailOrUsername, password } = values;\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <Root>\n        <InputContainer>\n          {error && (\n            <ErrorMessage>\n              <Error size=\"xxs\" color=\"white\">\n                {error}\n              </Error>\n            </ErrorMessage>\n          )}\n\n          <InputText\n            autoFocus\n            type=\"text\"\n            name=\"emailOrUsername\"\n            values={emailOrUsername}\n            onChange={handleChange}\n            placeholder=\"Email or Username\"\n            borderColor=\"white\"\n          />\n        </InputContainer>\n\n        <InputContainer left=\"xs\" right=\"xs\">\n          <InputText\n            type=\"password\"\n            name=\"password\"\n            values={password}\n            onChange={handleChange}\n            placeholder=\"Password\"\n            borderColor=\"white\"\n          />\n          <A to={Routes.FORGOT_PASSWORD}>\n            <ForgotPassword>Forgot password?</ForgotPassword>\n          </A>\n        </InputContainer>\n\n        <Button disabled={loading}>Log in</Button>\n      </Root>\n    </form>\n  );\n};\n\nSignIn.propTypes = {\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired,\n};\n\nexport default withRouter(SignIn);\n"]},"metadata":{},"sourceType":"module"}