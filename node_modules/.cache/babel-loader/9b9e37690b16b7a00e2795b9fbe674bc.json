{"ast":null,"code":"import _regeneratorRuntime from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/Users/hieutran/Desktop/create-social-network-master/frontend/src/components/Comment.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\nimport { generatePath } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport { CloseIcon } from 'components/icons';\nimport { A } from './Text';\nimport { Spacing } from './Layout';\nimport Avatar from 'components/Avatar';\nimport { GET_AUTH_USER, GET_USER } from 'graphql/user';\nimport { DELETE_COMMENT } from 'graphql/comment';\nimport { GET_POST, GET_POSTS, GET_FOLLOWED_POSTS } from 'graphql/post';\nimport { useNotifications } from '../hooks/useNotifications';\nimport { useStore } from 'store';\nimport * as Routes from 'routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar DeleteButton = styled.button(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  display: none;\\n  background-color: transparent;\\n  border: 0;\\n  outline: 0;\\n  position: absolute;\\n  right: 7px;\\n  top: 6px;\\n\"])));\n_c = DeleteButton;\nvar Root = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  padding: \", \" 0;\\n  font-size: \", \";\\n\\n  &:hover \", \" {\\n    display: block;\\n  }\\n\"])), function (p) {\n  return p.theme.spacing.xxs;\n}, function (p) {\n  return p.theme.font.size.xxs;\n}, DeleteButton);\n_c2 = Root;\nvar UserName = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  color: \", \";\\n  font-weight: \", \";\\n\"])), function (p) {\n  return p.theme.colors.primary.main;\n}, function (p) {\n  return p.theme.font.weight.bold;\n});\n_c3 = UserName;\nvar CommentSection = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  word-wrap: break-word;\\n  overflow: hidden;\\n  padding: 0 \", \" \", \" \", \";\\n  background-color: \", \";\\n  border-radius: \", \";\\n  margin-left: \", \";\\n  color: \", \";\\n\"])), function (p) {\n  return p.theme.spacing.lg;\n}, function (p) {\n  return p.theme.spacing.xxs;\n}, function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.colors.grey[100];\n}, function (p) {\n  return p.theme.radius.lg;\n}, function (p) {\n  return p.theme.spacing.xxs;\n}, function (p) {\n  return p.theme.colors.text.main;\n});\n/**\n * Renders comments UI\n */\n\n_c4 = CommentSection;\n\nvar Comment = function Comment(_ref) {\n  _s();\n\n  var comment = _ref.comment,\n      postId = _ref.postId,\n      postAuthor = _ref.postAuthor;\n\n  var _useStore = useStore(),\n      _useStore2 = _slicedToArray(_useStore, 1),\n      auth = _useStore2[0].auth;\n\n  var notification = useNotifications();\n\n  var _useMutation = useMutation(DELETE_COMMENT, {\n    refetchQueries: [{\n      query: GET_FOLLOWED_POSTS,\n      variables: {\n        userId: auth.user.id\n      }\n    }, {\n      query: GET_USER,\n      variables: {\n        username: comment.author.username\n      }\n    }, {\n      query: GET_AUTH_USER\n    }, {\n      query: GET_POSTS,\n      variables: {\n        authUserId: auth.user.id\n      }\n    }, {\n      query: GET_POST,\n      variables: {\n        id: postId\n      }\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      deleteComment = _useMutation2[0];\n\n  var handleDeleteComment = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var isNotified;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return deleteComment({\n                variables: {\n                  input: {\n                    id: comment.id\n                  }\n                }\n              });\n\n            case 2:\n              // Delete notification after comment deletion\n              if (auth.user.id !== postAuthor.id) {\n                isNotified = postAuthor.notifications.find(function (n) {\n                  return n.comment && n.comment.id === comment.id;\n                });\n                notification.remove({\n                  notificationId: isNotified.id\n                });\n              }\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleDeleteComment() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(Root, {\n    children: [/*#__PURE__*/_jsxDEV(A, {\n      to: generatePath(Routes.USER_PROFILE, {\n        username: comment.author.username\n      }),\n      children: /*#__PURE__*/_jsxDEV(Avatar, {\n        image: comment.author.image\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(CommentSection, {\n      children: [comment.author.id === auth.user.id && /*#__PURE__*/_jsxDEV(DeleteButton, {\n        onClick: handleDeleteComment,\n        children: /*#__PURE__*/_jsxDEV(CloseIcon, {\n          width: \"10\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(Spacing, {\n        top: \"xxs\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Spacing, {\n        inline: true,\n        right: \"xxs\",\n        children: /*#__PURE__*/_jsxDEV(A, {\n          to: generatePath(Routes.USER_PROFILE, {\n            username: comment.author.username\n          }),\n          children: /*#__PURE__*/_jsxDEV(UserName, {\n            children: comment.author.fullName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, _this), comment.comment]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Comment, \"NPLPndz3ziFwvpHcPHGI/VsrKDQ=\", false, function () {\n  return [useStore, useNotifications, useMutation];\n});\n\n_c5 = Comment;\nComment.propTypes = {\n  comment: PropTypes.object.isRequired,\n  postId: PropTypes.string.isRequired,\n  postAuthor: PropTypes.object.isRequired\n};\nexport default Comment;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"DeleteButton\");\n$RefreshReg$(_c2, \"Root\");\n$RefreshReg$(_c3, \"UserName\");\n$RefreshReg$(_c4, \"CommentSection\");\n$RefreshReg$(_c5, \"Comment\");","map":{"version":3,"sources":["/Users/hieutran/Desktop/create-social-network-master/frontend/src/components/Comment.js"],"names":["React","PropTypes","styled","generatePath","useMutation","CloseIcon","A","Spacing","Avatar","GET_AUTH_USER","GET_USER","DELETE_COMMENT","GET_POST","GET_POSTS","GET_FOLLOWED_POSTS","useNotifications","useStore","Routes","DeleteButton","button","Root","div","p","theme","spacing","xxs","font","size","UserName","colors","primary","main","weight","bold","CommentSection","lg","xs","grey","radius","text","Comment","comment","postId","postAuthor","auth","notification","refetchQueries","query","variables","userId","user","id","username","author","authUserId","deleteComment","handleDeleteComment","input","isNotified","notifications","find","n","remove","notificationId","USER_PROFILE","image","fullName","propTypes","object","isRequired","string"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\nimport { generatePath } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\n\nimport { CloseIcon } from 'components/icons';\nimport { A } from './Text';\nimport { Spacing } from './Layout';\nimport Avatar from 'components/Avatar';\n\nimport { GET_AUTH_USER, GET_USER } from 'graphql/user';\nimport { DELETE_COMMENT } from 'graphql/comment';\nimport { GET_POST, GET_POSTS, GET_FOLLOWED_POSTS } from 'graphql/post';\n\nimport { useNotifications } from '../hooks/useNotifications';\n\nimport { useStore } from 'store';\n\nimport * as Routes from 'routes';\n\nconst DeleteButton = styled.button`\n  cursor: pointer;\n  display: none;\n  background-color: transparent;\n  border: 0;\n  outline: 0;\n  position: absolute;\n  right: 7px;\n  top: 6px;\n`;\n\nconst Root = styled.div`\n  display: flex;\n  flex-direction: row;\n  padding: ${(p) => p.theme.spacing.xxs} 0;\n  font-size: ${(p) => p.theme.font.size.xxs};\n\n  &:hover ${DeleteButton} {\n    display: block;\n  }\n`;\n\nconst UserName = styled.div`\n  color: ${(p) => p.theme.colors.primary.main};\n  font-weight: ${(p) => p.theme.font.weight.bold};\n`;\n\nconst CommentSection = styled.div`\n  position: relative;\n  word-wrap: break-word;\n  overflow: hidden;\n  padding: 0 ${(p) => p.theme.spacing.lg} ${(p) => p.theme.spacing.xxs} ${(p) => p.theme.spacing.xs};\n  background-color: ${(p) => p.theme.colors.grey[100]};\n  border-radius: ${(p) => p.theme.radius.lg};\n  margin-left: ${(p) => p.theme.spacing.xxs};\n  color: ${(p) => p.theme.colors.text.main};\n`;\n\n/**\n * Renders comments UI\n */\nconst Comment = ({ comment, postId, postAuthor }) => {\n  const [{ auth }] = useStore();\n  const notification = useNotifications();\n  const [deleteComment] = useMutation(DELETE_COMMENT, {\n    refetchQueries: [\n      { query: GET_FOLLOWED_POSTS, variables: { userId: auth.user.id } },\n      { query: GET_USER, variables: { username: comment.author.username } },\n      { query: GET_AUTH_USER },\n      { query: GET_POSTS, variables: { authUserId: auth.user.id } },\n      { query: GET_POST, variables: { id: postId } },\n    ],\n  });\n\n  const handleDeleteComment = async () => {\n    await deleteComment({ variables: { input: { id: comment.id } } });\n\n    // Delete notification after comment deletion\n    if (auth.user.id !== postAuthor.id) {\n      const isNotified = postAuthor.notifications.find((n) => n.comment && n.comment.id === comment.id);\n      notification.remove({\n        notificationId: isNotified.id,\n      });\n    }\n  };\n\n  return (\n    <Root>\n      <A\n        to={generatePath(Routes.USER_PROFILE, {\n          username: comment.author.username,\n        })}\n      >\n        <Avatar image={comment.author.image} />\n      </A>\n\n      <CommentSection>\n        {comment.author.id === auth.user.id && (\n          <DeleteButton onClick={handleDeleteComment}>\n            <CloseIcon width=\"10\" />\n          </DeleteButton>\n        )}\n\n        <Spacing top=\"xxs\" />\n\n        <Spacing inline right=\"xxs\">\n          <A\n            to={generatePath(Routes.USER_PROFILE, {\n              username: comment.author.username,\n            })}\n          >\n            <UserName>{comment.author.fullName}</UserName>\n          </A>\n        </Spacing>\n\n        {comment.comment}\n      </CommentSection>\n    </Root>\n  );\n};\n\nComment.propTypes = {\n  comment: PropTypes.object.isRequired,\n  postId: PropTypes.string.isRequired,\n  postAuthor: PropTypes.object.isRequired,\n};\n\nexport default Comment;\n"]},"metadata":{},"sourceType":"module"}