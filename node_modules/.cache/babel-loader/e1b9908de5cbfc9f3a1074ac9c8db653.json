{"ast":null,"code":"import _regeneratorRuntime from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/Users/hieutran/Desktop/create-social-network-master/frontend/src/pages/Auth/ResetPassword.js\",\n    _templateObject,\n    _templateObject2,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useQuery, useMutation } from '@apollo/client';\nimport { Spacing } from 'components/Layout';\nimport { H1, Error } from 'components/Text';\nimport { Loading } from 'components/Loading';\nimport { InputText, Button } from 'components/Form';\nimport Head from 'components/Head';\nimport { VERIFY_RESET_PASSWORD_TOKEN, RESET_PASSWORD } from 'graphql/user';\nimport * as Routes from 'routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar Root = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  padding: 0 \", \";\\n\"])), function (p) {\n  return p.theme.spacing.sm;\n});\n_c = Root;\nvar Container = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  margin: 0 auto;\\n  background-color: \", \";\\n  padding: \", \";\\n  border-radius: \", \";\\n  margin-top: 80px;\\n\\n  @media (min-width: \", \") {\\n    width: 450px;\\n  }\\n\\n  @media (min-width: \", \") {\\n    margin-top: auto;\\n  }\\n\"])), function (p) {\n  return p.theme.colors.white;\n}, function (p) {\n  return p.theme.spacing.md;\n}, function (p) {\n  return p.theme.radius.sm;\n}, function (p) {\n  return p.theme.screen.sm;\n}, function (p) {\n  return p.theme.screen.md;\n});\n/**\n * Reset password page\n */\n\n_c2 = Container;\n\nvar ResetPassword = function ResetPassword(_ref) {\n  _s();\n\n  var history = _ref.history,\n      location = _ref.location,\n      refetch = _ref.refetch;\n\n  var _useState = useState({\n    password: '',\n    confirmPassword: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      values = _useState2[0],\n      setValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mutationError = _useState6[0],\n      setMutationError = _useState6[1];\n\n  var url = new URLSearchParams(location.search);\n  var email = url.get('email');\n  var token = url.get('token');\n\n  var _useQuery = useQuery(VERIFY_RESET_PASSWORD_TOKEN, {\n    variables: {\n      email: email,\n      token: token\n    }\n  }),\n      queryLoading = _useQuery.queryLoading,\n      queryError = _useQuery.error;\n\n  var password = values.password,\n      confirmPassword = values.confirmPassword;\n\n  var _useMutation = useMutation(RESET_PASSWORD),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      resetPassword = _useMutation2[0],\n      mutationLoading = _useMutation2[1].loading;\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setValues(_objectSpread(_objectSpread({}, values), {}, _defineProperty({}, name, value)));\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!(!password || !confirmPassword)) {\n                _context.next = 6;\n                break;\n              }\n\n              setError('Enter password and Confirm password.');\n              return _context.abrupt(\"return\");\n\n            case 6:\n              if (!(password.length < 6)) {\n                _context.next = 11;\n                break;\n              }\n\n              setError('Password min 6 characters');\n              return _context.abrupt(\"return\");\n\n            case 11:\n              if (!(password !== confirmPassword)) {\n                _context.next = 14;\n                break;\n              }\n\n              setError(\"Passwords don't match.\");\n              return _context.abrupt(\"return\");\n\n            case 14:\n              setError('');\n              setMutationError('');\n              _context.prev = 16;\n              _context.next = 19;\n              return resetPassword({\n                variables: {\n                  input: {\n                    email: email,\n                    password: password,\n                    token: token\n                  }\n                }\n              });\n\n            case 19:\n              response = _context.sent;\n              localStorage.setItem('token', response.data.resetPassword.token);\n              _context.next = 23;\n              return refetch();\n\n            case 23:\n              history.push(Routes.HOME);\n              _context.next = 29;\n              break;\n\n            case 26:\n              _context.prev = 26;\n              _context.t0 = _context[\"catch\"](16);\n              setMutationError(_context.t0.graphQLErrors[0].message);\n\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[16, 26]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(Root, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      title: \"Reset Password\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [queryLoading && /*#__PURE__*/_jsxDEV(Loading, {\n          top: \"lg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 28\n        }, _this), mutationError || queryError ? /*#__PURE__*/_jsxDEV(Spacing, {\n          bottom: \"md\",\n          children: /*#__PURE__*/_jsxDEV(Error, {\n            children: mutationError ? mutationError : queryError.graphQLErrors[0].message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, _this) : '', /*#__PURE__*/_jsxDEV(Spacing, {\n          bottom: \"md\",\n          children: /*#__PURE__*/_jsxDEV(H1, {\n            children: \"Password Reset\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: function onSubmit(e) {\n            return handleSubmit(e, resetPassword);\n          },\n          children: [/*#__PURE__*/_jsxDEV(InputText, {\n            type: \"password\",\n            name: \"password\",\n            values: password,\n            onChange: handleChange,\n            placeholder: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Spacing, {\n            top: \"xs\",\n            bottom: \"sm\",\n            children: /*#__PURE__*/_jsxDEV(InputText, {\n              type: \"password\",\n              name: \"confirmPassword\",\n              values: confirmPassword,\n              onChange: handleChange,\n              placeholder: \"Confirm Password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, _this), error && /*#__PURE__*/_jsxDEV(Spacing, {\n            bottom: \"sm\",\n            top: \"sm\",\n            children: /*#__PURE__*/_jsxDEV(Error, {\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(Button, {\n            disabled: mutationLoading,\n            children: \"Reset Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(ResetPassword, \"A/T7OD48ocglTtUcgKcV6WWVMtM=\", false, function () {\n  return [useQuery, useMutation];\n});\n\n_c3 = ResetPassword;\nResetPassword.propTypes = {\n  location: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired\n};\nexport default _c4 = withRouter(ResetPassword);\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Root\");\n$RefreshReg$(_c2, \"Container\");\n$RefreshReg$(_c3, \"ResetPassword\");\n$RefreshReg$(_c4, \"%default%\");","map":{"version":3,"sources":["/Users/hieutran/Desktop/create-social-network-master/frontend/src/pages/Auth/ResetPassword.js"],"names":["React","useState","styled","PropTypes","withRouter","useQuery","useMutation","Spacing","H1","Error","Loading","InputText","Button","Head","VERIFY_RESET_PASSWORD_TOKEN","RESET_PASSWORD","Routes","Root","div","p","theme","spacing","sm","Container","colors","white","md","radius","screen","ResetPassword","history","location","refetch","password","confirmPassword","values","setValues","error","setError","mutationError","setMutationError","url","URLSearchParams","search","email","get","token","variables","queryLoading","queryError","resetPassword","mutationLoading","loading","handleChange","e","target","name","value","handleSubmit","preventDefault","length","input","response","localStorage","setItem","data","push","HOME","graphQLErrors","message","propTypes","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useQuery, useMutation } from '@apollo/client';\nimport { Spacing } from 'components/Layout';\nimport { H1, Error } from 'components/Text';\nimport { Loading } from 'components/Loading';\nimport { InputText, Button } from 'components/Form';\nimport Head from 'components/Head';\n\nimport { VERIFY_RESET_PASSWORD_TOKEN, RESET_PASSWORD } from 'graphql/user';\n\nimport * as Routes from 'routes';\n\nconst Root = styled.div`\n  padding: 0 ${(p) => p.theme.spacing.sm};\n`;\n\nconst Container = styled.div`\n  width: 100%;\n  margin: 0 auto;\n  background-color: ${(p) => p.theme.colors.white};\n  padding: ${(p) => p.theme.spacing.md};\n  border-radius: ${(p) => p.theme.radius.sm};\n  margin-top: 80px;\n\n  @media (min-width: ${(p) => p.theme.screen.sm}) {\n    width: 450px;\n  }\n\n  @media (min-width: ${(p) => p.theme.screen.md}) {\n    margin-top: auto;\n  }\n`;\n\n/**\n * Reset password page\n */\nconst ResetPassword = ({ history, location, refetch }) => {\n  const [values, setValues] = useState({ password: '', confirmPassword: '' });\n  const [error, setError] = useState('');\n  const [mutationError, setMutationError] = useState('');\n  const url = new URLSearchParams(location.search);\n  const email = url.get('email');\n  const token = url.get('token');\n  const { queryLoading, error: queryError } = useQuery(VERIFY_RESET_PASSWORD_TOKEN, {\n    variables: { email, token },\n  });\n  const { password, confirmPassword } = values;\n  const [resetPassword, { loading: mutationLoading }] = useMutation(RESET_PASSWORD);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setValues({ ...values, [name]: value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!password || !confirmPassword) {\n      setError('Enter password and Confirm password.');\n      return;\n    } else if (password.length < 6) {\n      setError('Password min 6 characters');\n      return;\n    } else if (password !== confirmPassword) {\n      setError(\"Passwords don't match.\");\n      return;\n    }\n\n    setError('');\n    setMutationError('');\n    try {\n      const response = await resetPassword({\n        variables: { input: { email, password, token } },\n      });\n      localStorage.setItem('token', response.data.resetPassword.token);\n      await refetch();\n      history.push(Routes.HOME);\n    } catch (error) {\n      setMutationError(error.graphQLErrors[0].message);\n    }\n  };\n\n  return (\n    <Root>\n      <Head title=\"Reset Password\" />\n\n      <Container>\n        <>\n          {queryLoading && <Loading top=\"lg\" />}\n          {mutationError || queryError ? (\n            <Spacing bottom=\"md\">\n              <Error>{mutationError ? mutationError : queryError.graphQLErrors[0].message}</Error>\n            </Spacing>\n          ) : (\n            ''\n          )}\n\n          <Spacing bottom=\"md\">\n            <H1>Password Reset</H1>\n          </Spacing>\n\n          <form onSubmit={(e) => handleSubmit(e, resetPassword)}>\n            <InputText\n              type=\"password\"\n              name=\"password\"\n              values={password}\n              onChange={handleChange}\n              placeholder=\"Password\"\n            />\n\n            <Spacing top=\"xs\" bottom=\"sm\">\n              <InputText\n                type=\"password\"\n                name=\"confirmPassword\"\n                values={confirmPassword}\n                onChange={handleChange}\n                placeholder=\"Confirm Password\"\n              />\n            </Spacing>\n\n            {error && (\n              <Spacing bottom=\"sm\" top=\"sm\">\n                <Error>{error}</Error>\n              </Spacing>\n            )}\n\n            <Button disabled={mutationLoading}>Reset Password</Button>\n          </form>\n        </>\n      </Container>\n    </Root>\n  );\n};\n\nResetPassword.propTypes = {\n  location: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired,\n};\n\nexport default withRouter(ResetPassword);\n"]},"metadata":{},"sourceType":"module"}