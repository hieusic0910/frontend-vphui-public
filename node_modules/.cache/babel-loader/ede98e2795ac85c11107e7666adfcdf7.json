{"ast":null,"code":"import _regeneratorRuntime from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/hieutran/Desktop/create-social-network-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/Users/hieutran/Desktop/create-social-network-master/frontend/src/components/App/Notification.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _templateObject5,\n    _templateObject6,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { generatePath } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { useApolloClient } from '@apollo/client';\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport Avatar from 'components/Avatar';\nimport { useClickOutside } from 'hooks/useClickOutside';\nimport { GET_AUTH_USER } from 'graphql/user';\nimport { UPDATE_NOTIFICATION_SEEN } from 'graphql/notification';\nimport { useStore } from 'store';\nimport * as Routes from 'routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar NotificationItem = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n  align-items: center;\\n  padding: \", \";\\n  border-bottom: 1px solid \", \";\\n  font-size: \", \";\\n  background-color: \", \";\\n\\n  &:last-child {\\n    border-bottom: 0;\\n  }\\n\"])), function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.colors.border.main;\n}, function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.colors.white;\n});\n_c = NotificationItem;\nvar LeftSide = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n\"])));\n_c2 = LeftSide;\nvar Name = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  font-weight: \", \";\\n\"])), function (p) {\n  return p.theme.font.weight.bold;\n});\n_c3 = Name;\nvar Action = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  justify-content: space-between;\\n  flex: 1;\\n  margin-left: \", \";\\n\"])), function (p) {\n  return p.theme.spacing.xs;\n});\n_c4 = Action;\nvar PostImage = styled.div(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n  width: 40px;\\n  height: 40px;\\n  overflow: hidden;\\n\"])));\n_c5 = PostImage;\nvar Image = styled.img(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  display: block;\\n\"])));\n/**\n * Renders user notifications\n */\n\n_c6 = Image;\n\nvar Notification = function Notification(_ref) {\n  _s();\n\n  var notification = _ref.notification,\n      close = _ref.close;\n\n  var _useStore = useStore(),\n      _useStore2 = _slicedToArray(_useStore, 1),\n      auth = _useStore2[0].auth;\n\n  var client = useApolloClient();\n  var ref = React.useRef(null);\n  useClickOutside(ref, close);\n  useEffect(function () {\n    var updateNotificationSeen = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return client.mutate({\n                  mutation: UPDATE_NOTIFICATION_SEEN,\n                  variables: {\n                    input: {\n                      userId: auth.user.id\n                    }\n                  },\n                  refetchQueries: function refetchQueries() {\n                    return [{\n                      query: GET_AUTH_USER\n                    }];\n                  }\n                });\n\n              case 3:\n                _context.next = 7;\n                break;\n\n              case 5:\n                _context.prev = 5;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 5]]);\n      }));\n\n      return function updateNotificationSeen() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    updateNotificationSeen();\n  }, [auth.user.id, auth.user.newNotifications.length, client]);\n\n  if (!notification.follow && !notification.like && !notification.comment) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(NotificationItem, {\n    ref: ref,\n    children: [/*#__PURE__*/_jsxDEV(A, {\n      to: generatePath(Routes.USER_PROFILE, {\n        username: notification.author.username\n      }),\n      children: /*#__PURE__*/_jsxDEV(LeftSide, {\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          image: notification.author.image,\n          size: 34\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Spacing, {\n          left: \"xs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Name, {\n          children: notification.author.fullName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, _this), notification.follow && /*#__PURE__*/_jsxDEV(Action, {\n      children: \"started following you\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 31\n    }, _this), notification.like && /*#__PURE__*/_jsxDEV(Action, {\n      children: [\"likes your photo\", /*#__PURE__*/_jsxDEV(A, {\n        to: generatePath(Routes.POST, {\n          id: notification.like.post.id\n        }),\n        children: /*#__PURE__*/_jsxDEV(PostImage, {\n          children: /*#__PURE__*/_jsxDEV(Image, {\n            src: notification.like.post.image\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, _this), notification.comment && /*#__PURE__*/_jsxDEV(Action, {\n      children: [\"commented on your photo\", /*#__PURE__*/_jsxDEV(A, {\n        to: generatePath(Routes.POST, {\n          id: notification.comment.post.id\n        }),\n        children: /*#__PURE__*/_jsxDEV(PostImage, {\n          children: /*#__PURE__*/_jsxDEV(Image, {\n            src: notification.comment.post.image\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Notification, \"fIctpoER+XFG5CByU4wSssvlPgA=\", false, function () {\n  return [useStore, useApolloClient, useClickOutside];\n});\n\n_c7 = Notification;\nNotification.propTypes = {\n  close: PropTypes.func\n};\nexport default Notification;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n\n$RefreshReg$(_c, \"NotificationItem\");\n$RefreshReg$(_c2, \"LeftSide\");\n$RefreshReg$(_c3, \"Name\");\n$RefreshReg$(_c4, \"Action\");\n$RefreshReg$(_c5, \"PostImage\");\n$RefreshReg$(_c6, \"Image\");\n$RefreshReg$(_c7, \"Notification\");","map":{"version":3,"sources":["/Users/hieutran/Desktop/create-social-network-master/frontend/src/components/App/Notification.js"],"names":["React","useEffect","PropTypes","generatePath","styled","useApolloClient","A","Spacing","Avatar","useClickOutside","GET_AUTH_USER","UPDATE_NOTIFICATION_SEEN","useStore","Routes","NotificationItem","div","p","theme","spacing","xs","colors","border","main","font","size","xxs","white","LeftSide","Name","weight","bold","Action","PostImage","Image","img","Notification","notification","close","auth","client","ref","useRef","updateNotificationSeen","mutate","mutation","variables","input","userId","user","id","refetchQueries","query","newNotifications","length","follow","like","comment","USER_PROFILE","username","author","image","fullName","POST","post","propTypes","func"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { generatePath } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { useApolloClient } from '@apollo/client';\n\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport Avatar from 'components/Avatar';\n\nimport { useClickOutside } from 'hooks/useClickOutside';\n\nimport { GET_AUTH_USER } from 'graphql/user';\nimport { UPDATE_NOTIFICATION_SEEN } from 'graphql/notification';\n\nimport { useStore } from 'store';\n\nimport * as Routes from 'routes';\n\nconst NotificationItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: ${(p) => p.theme.spacing.xs};\n  border-bottom: 1px solid ${(p) => p.theme.colors.border.main};\n  font-size: ${(p) => p.theme.font.size.xxs};\n  background-color: ${(p) => p.theme.colors.white};\n\n  &:last-child {\n    border-bottom: 0;\n  }\n`;\n\nconst LeftSide = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst Name = styled.div`\n  font-weight: ${(p) => p.theme.font.weight.bold};\n`;\n\nconst Action = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  flex: 1;\n  margin-left: ${(p) => p.theme.spacing.xs};\n`;\n\nconst PostImage = styled.div`\n  width: 40px;\n  height: 40px;\n  overflow: hidden;\n`;\n\nconst Image = styled.img`\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  display: block;\n`;\n\n/**\n * Renders user notifications\n */\nconst Notification = ({ notification, close }) => {\n  const [{ auth }] = useStore();\n  const client = useApolloClient();\n  const ref = React.useRef(null);\n\n  useClickOutside(ref, close);\n\n  useEffect(() => {\n    const updateNotificationSeen = async () => {\n      try {\n        await client.mutate({\n          mutation: UPDATE_NOTIFICATION_SEEN,\n          variables: {\n            input: {\n              userId: auth.user.id,\n            },\n          },\n          refetchQueries: () => [{ query: GET_AUTH_USER }],\n        });\n      } catch (err) {}\n    };\n\n    updateNotificationSeen();\n  }, [auth.user.id, auth.user.newNotifications.length, client]);\n\n  if (!notification.follow && !notification.like && !notification.comment) {\n    return null;\n  }\n\n  return (\n    <NotificationItem ref={ref}>\n      <A\n        to={generatePath(Routes.USER_PROFILE, {\n          username: notification.author.username,\n        })}\n      >\n        <LeftSide>\n          <Avatar image={notification.author.image} size={34} />\n\n          <Spacing left=\"xs\" />\n\n          <Name>{notification.author.fullName}</Name>\n        </LeftSide>\n      </A>\n\n      {notification.follow && <Action>started following you</Action>}\n\n      {notification.like && (\n        <Action>\n          likes your photo\n          <A to={generatePath(Routes.POST, { id: notification.like.post.id })}>\n            <PostImage>\n              <Image src={notification.like.post.image} />\n            </PostImage>\n          </A>\n        </Action>\n      )}\n\n      {notification.comment && (\n        <Action>\n          commented on your photo\n          <A to={generatePath(Routes.POST, { id: notification.comment.post.id })}>\n            <PostImage>\n              <Image src={notification.comment.post.image} />\n            </PostImage>\n          </A>\n        </Action>\n      )}\n    </NotificationItem>\n  );\n};\n\nNotification.propTypes = {\n  close: PropTypes.func,\n};\n\nexport default Notification;\n"]},"metadata":{},"sourceType":"module"}